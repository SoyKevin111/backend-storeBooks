import{a as Y}from"./chunk-46J4RIDY.js";import{a as E,b as ne}from"./chunk-O22OUVCV.js";import"./chunk-YGPISVLE.js";import{a as oe}from"./chunk-ZYMZNC6O.js";import{a as Z,b as ee,c as te,d as re}from"./chunk-AJFPFQIJ.js";import"./chunk-HRF36MJC.js";import{b as R,c as u,d as j,e as G,h as z,i as K,j as U,k as H,m as J,n as Q,o as W,q as X}from"./chunk-OFSUVZPS.js";import{a as P}from"./chunk-S4B3EVCZ.js";import"./chunk-BJIYRU5B.js";import{f as N}from"./chunk-2T54QLAV.js";import{Ja as m,Ua as p,Xa as a,_b as A,a as O,aa as f,ab as D,ac as $,bb as M,cb as B,db as i,eb as o,ec as L,fb as v,ga as F,ib as V,jb as _,kb as c,mb as s,ob as T,pa as k,qa as q,ub as S}from"./chunk-UTOI2SA5.js";import{a as w}from"./chunk-FDERIQAA.js";function ae(t,r){t&1&&(i(0,"div"),s(1,"First name is required."),o())}function se(t,r){t&1&&(i(0,"div"),s(1,"Max 30 characters."),o())}function de(t,r){t&1&&(i(0,"div"),s(1,"Cannot be blank or spaces only."),o())}function ue(t,r){if(t&1&&(i(0,"div",26),p(1,ae,2,0,"div",27)(2,se,2,0,"div",27)(3,de,2,0,"div",27),o()),t&2){let n,e,l,d=c();m(),a("ngIf",(n=d.customerForm.get("name"))==null||n.errors==null?null:n.errors.required),m(),a("ngIf",(e=d.customerForm.get("name"))==null||e.errors==null?null:e.errors.maxlength),m(),a("ngIf",(l=d.customerForm.get("name"))==null||l.errors==null?null:l.errors.pattern)}}function pe(t,r){t&1&&(i(0,"div"),s(1,"Last name is required."),o())}function ce(t,r){t&1&&(i(0,"div"),s(1,"Max 30 characters."),o())}function fe(t,r){t&1&&(i(0,"div"),s(1,"Cannot be blank or spaces only."),o())}function _e(t,r){if(t&1&&(i(0,"div",26),p(1,pe,2,0,"div",27)(2,ce,2,0,"div",27)(3,fe,2,0,"div",27),o()),t&2){let n,e,l,d=c();m(),a("ngIf",(n=d.customerForm.get("lastName"))==null||n.errors==null?null:n.errors.required),m(),a("ngIf",(e=d.customerForm.get("lastName"))==null||e.errors==null?null:e.errors.maxlength),m(),a("ngIf",(l=d.customerForm.get("lastName"))==null||l.errors==null?null:l.errors.pattern)}}function ve(t,r){t&1&&(i(0,"div"),s(1,"identityNumber number is required."),o())}function ge(t,r){t&1&&(i(0,"div"),s(1,"identityNumber must be 10 digits."),o())}function Ce(t,r){if(t&1&&(i(0,"div",26),p(1,ve,2,0,"div",27)(2,ge,2,0,"div",27),o()),t&2){let n,e,l=c();m(),a("ngIf",(n=l.customerForm.get("identityNumber"))==null||n.errors==null?null:n.errors.required),m(),a("ngIf",(e=l.customerForm.get("identityNumber"))==null||e.errors==null?null:e.errors.pattern)}}function he(t,r){t&1&&(i(0,"div"),s(1,"Date of birth is required."),o())}function be(t,r){if(t&1&&(i(0,"div",26),p(1,he,2,0,"div",27),o()),t&2){let n,e=c();m(),a("ngIf",(n=e.customerForm.get("dateOfBirth"))==null||n.errors==null?null:n.errors.required)}}function ye(t,r){t&1&&(i(0,"div"),s(1,"Address is required."),o())}function xe(t,r){t&1&&(i(0,"div"),s(1,"Max 50 characters."),o())}function Fe(t,r){t&1&&(i(0,"div"),s(1,"Cannot be blank or spaces only."),o())}function Se(t,r){if(t&1&&(i(0,"div",26),p(1,ye,2,0,"div",27)(2,xe,2,0,"div",27)(3,Fe,2,0,"div",27),o()),t&2){let n,e,l,d=c();m(),a("ngIf",(n=d.customerForm.get("address"))==null||n.errors==null?null:n.errors.required),m(),a("ngIf",(e=d.customerForm.get("address"))==null||e.errors==null?null:e.errors.maxlength),m(),a("ngIf",(l=d.customerForm.get("address"))==null||l.errors==null?null:l.errors.pattern)}}function Ee(t,r){t&1&&(i(0,"div"),s(1,"Phone number is required."),o())}function Ne(t,r){t&1&&(i(0,"div"),s(1,"Phone must be 7 to 15 digits."),o())}function Te(t,r){if(t&1&&(i(0,"div",26),p(1,Ee,2,0,"div",27)(2,Ne,2,0,"div",27),o()),t&2){let n,e,l=c();m(),a("ngIf",(n=l.customerForm.get("phone"))==null||n.errors==null?null:n.errors.required),m(),a("ngIf",(e=l.customerForm.get("phone"))==null||e.errors==null?null:e.errors.pattern)}}function Ie(t,r){if(t&1){let n=V();i(0,"div",28),_("click",function(){let l=k(n).$implicit,d=c();return q(d.selectState(l))}),s(1),o()}if(t&2){let n=r.$implicit;m(),T(" ",n," ")}}function we(t,r){t&1&&(i(0,"div"),s(1,"State is required."),o())}function Oe(t,r){t&1&&(i(0,"div"),s(1,"Invalid state selected."),o())}function ke(t,r){if(t&1&&(i(0,"div",26),p(1,we,2,0,"div",27)(2,Oe,2,0,"div",27),o()),t&2){let n,e,l=c();m(),a("ngIf",(n=l.customerForm.get("state"))==null||n.errors==null?null:n.errors.required),m(),a("ngIf",(e=l.customerForm.get("state"))==null||e.errors==null?null:e.errors.invalidState)}}var g=class t{fb=f(W);store=f(N);modalService=f(E);functionTyeEm="";customer;animationState="modal-animate-in";toggleState=!1;stateOptions=["ACTIVE","INACTIVE"];customerForm=this.fb.group({name:["",[u.required,u.maxLength(30),u.pattern(/^(?!\s*$).+/)]],lastName:["",[u.required,u.maxLength(30),u.pattern(/^(?!\s*$).+/)]],identityNumber:["",[u.required,u.pattern(/^\d{10}$/)]],dateOfBirth:["",u.required],address:["",[u.required,u.maxLength(50),u.pattern(/^(?!\s*$).+/)]],phone:["",[u.required,u.pattern(/^\d{7,15}$/)]],state:["",[u.required,r=>this.stateOptions.includes(r.value)?null:{invalidState:!0}]]});ngOnInit(){this.customer&&this.customerForm.patchValue(w({},this.customer))}allowOnlyNumbers(r){let n=r.charCode;(n<48||n>57)&&r.preventDefault()}selectState(r){this.customerForm.get("state")?.setValue(r),this.toggleState=!1}onSubmit(){if(this.customerForm.valid)this.save(),this.close();else{this.customerForm.markAllAsTouched();for(let[r,n]of Object.entries(this.customerForm.controls))n.errors&&console.log(`Errores en ${r}:`,n.errors)}}save(){let r=e=>e==null||typeof e=="string"&&e.trim()===""?null:e,n={id:this.customer?Number(this.customer.id):0,name:r(this.customerForm.get("name")?.value),lastName:r(this.customerForm.get("lastName")?.value),identityNumber:r(this.customerForm.get("identityNumber")?.value?String(this.customerForm.get("identityNumber")?.value):null),dateOfBirth:r(this.customerForm.get("dateOfBirth")?.value),address:r(this.customerForm.get("address")?.value),phone:r(this.customerForm.get("phone")?.value?String(this.customerForm.get("phone")?.value):null),state:r(this.customerForm.get("state")?.value)};console.log("Customer Data:",n),this.customer?this.store.dispatch(te({editedItem:n})):this.store.dispatch(ee({newItem:n}))}close(){this.animationState="modal-animate-out",setTimeout(()=>this.modalService.close(),150)}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=F({type:t,selectors:[["app-form-customer"]],inputs:{functionTyeEm:"functionTyeEm",customer:"customer"},standalone:!0,features:[S],decls:50,vars:12,consts:[[1,"fixed","inset-0","bg-black","bg-opacity-60","z-40","flex","items-center","justify-center"],[1,"w-[500px]","bg-white","rounded-xl","shadow-lg","mx-4","md:mx-0",3,"ngClass"],[1,"py-8","text-center","font-bold","text-2xl","text-gray-800"],[1,"px-8","pb-8","space-y-6",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["for","name",1,"block","mb-2","text-sm","font-medium","text-gray-900"],["type","text","id","name","formControlName","name","placeholder","Enter first name",1,"w-full","border","border-gray-300","rounded-lg","px-3","py-2","shadow-sm","focus:ring","focus:border"],["class","text-red-500 text-sm mt-1",4,"ngIf"],["for","lastname",1,"block","mb-2","text-sm","font-medium","text-gray-900"],["type","text","id","lastname","formControlName","lastName","placeholder","Enter last name",1,"w-full","border","border-gray-300","rounded-lg","px-3","py-2","shadow-sm","focus:ring","focus:border"],["for","identityNumber",1,"block","mb-2","text-sm","font-medium","text-gray-900"],["type","text","id","identityNumber","formControlName","identityNumber","maxlength","10","pattern","\\d*","placeholder","Enter identity number",1,"w-full","border","border-gray-300","rounded-lg","px-3","py-2","shadow-sm","focus:ring","focus:border","no-spinner",3,"keypress"],[1,"grid","grid-cols-2","md:grid-cols-2","gap-4"],["for","dateOfBirth",1,"block","mb-2","text-sm","font-medium","text-gray-900"],["type","date","id","dateOfBirth","formControlName","dateOfBirth",1,"w-full","border","border-gray-300","rounded-lg","px-3","py-2","shadow-sm","focus:ring","focus:border"],["for","address",1,"block","mb-2","text-sm","font-medium","text-gray-900"],["type","text","id","address","formControlName","address","placeholder","Enter address",1,"w-full","border","border-gray-300","rounded-lg","px-3","py-2","shadow-sm","focus:ring","focus:border"],["for","phone",1,"block","mb-2","text-sm","font-medium","text-gray-900"],["type","number","id","phone","formControlName","phone","placeholder","Enter phone number",1,"w-full","border","border-gray-300","rounded-lg","px-3","py-2","shadow-sm","focus:ring","focus:border","no-spinner"],[1,"relative"],[1,"block","mb-2","text-sm","font-medium","text-gray-900"],["type","button",1,"w-full","border","border-gray-300","rounded","px-4","py-2","text-left","bg-white","shadow-sm","hover:bg-gray-50",3,"click"],[1,"float-right"],[1,"absolute","z-10","w-full","mt-1","bg-white","border","border-gray-300","rounded","shadow-md","max-h-60","overflow-y-auto",3,"ngClass"],[1,"px-4","py-2","hover:bg-gray-100","cursor-pointer"],[3,"closeModal","functionTyeRec"],[1,"text-red-500","text-sm","mt-1"],[4,"ngIf"],[1,"px-4","py-2","hover:bg-gray-100","cursor-pointer",3,"click"]],template:function(n,e){if(n&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2),s(3,"CUSTOMER FORM"),o(),i(4,"form",3),_("ngSubmit",function(){return e.onSubmit()}),i(5,"div",4)(6,"div")(7,"label",5),s(8,"First Name"),o(),v(9,"input",6),p(10,ue,4,3,"div",7),o(),i(11,"div")(12,"label",8),s(13,"Last Name"),o(),v(14,"input",9),p(15,_e,4,3,"div",7),o()(),i(16,"div")(17,"label",10),s(18,"Identity Number"),o(),i(19,"input",11),_("keypress",function(d){return e.allowOnlyNumbers(d)}),o(),p(20,Ce,3,2,"div",7),o(),i(21,"div",12)(22,"div")(23,"label",13),s(24,"Date of Birth"),o(),v(25,"input",14),p(26,be,2,1,"div",7),o()(),i(27,"div")(28,"label",15),s(29,"Address"),o(),v(30,"input",16),p(31,Se,4,3,"div",7),o(),i(32,"div",4)(33,"div")(34,"label",17),s(35,"Phone"),o(),v(36,"input",18),p(37,Te,3,2,"div",7),o(),i(38,"div",19)(39,"label",20),s(40,"State"),o(),i(41,"button",21),_("click",function(){return e.toggleState=!e.toggleState}),s(42),i(43,"span",22),s(44,"\u25BC"),o()(),i(45,"div",23),M(46,Ie,2,1,"div",24,D),o(),p(48,ke,3,2,"div",7),o()(),i(49,"app-cancel-save-buttons",25),_("closeModal",function(){return e.close()}),o()()()()),n&2){let l,d,C,h,b,y,I,x;m(),a("ngClass",e.animationState),m(3),a("formGroup",e.customerForm),m(6),a("ngIf",((l=e.customerForm.get("name"))==null?null:l.touched)&&((l=e.customerForm.get("name"))==null?null:l.invalid)),m(5),a("ngIf",((d=e.customerForm.get("lastName"))==null?null:d.touched)&&((d=e.customerForm.get("lastName"))==null?null:d.invalid)),m(5),a("ngIf",((C=e.customerForm.get("identityNumber"))==null?null:C.touched)&&((C=e.customerForm.get("identityNumber"))==null?null:C.invalid)),m(6),a("ngIf",((h=e.customerForm.get("dateOfBirth"))==null?null:h.touched)&&((h=e.customerForm.get("dateOfBirth"))==null?null:h.invalid)),m(5),a("ngIf",((b=e.customerForm.get("address"))==null?null:b.touched)&&((b=e.customerForm.get("address"))==null?null:b.invalid)),m(6),a("ngIf",((y=e.customerForm.get("phone"))==null?null:y.touched)&&((y=e.customerForm.get("phone"))==null?null:y.invalid)),m(5),T(" ",((I=e.customerForm.get("state"))==null?null:I.value)||"Choose State"," "),m(3),a("ngClass",e.toggleState?"block":"hidden"),m(),B(e.stateOptions),m(2),a("ngIf",((x=e.customerForm.get("state"))==null?null:x.touched)&&((x=e.customerForm.get("state"))==null?null:x.invalid)),m(),a("functionTyeRec",e.functionTyeEm)}},dependencies:[L,A,$,X,z,R,K,j,G,J,Q,U,H,Y]})};var ie=class t{store=f(N);modalService=f(E);notificationService=f(ne);subscription=new O;customers$=[];columns=[{field:"id",header:"Id"},{field:"name",header:"Name"},{field:"lastName",header:"Last Name"},{field:"dateOfBirth",header:"Date of Birth"},{field:"identityNumber",header:"Identification number"},{field:"address",header:"Address"},{field:"phone",header:"Phone"},{field:"state",header:"State"}];ngOnInit(){let r=!1,n=this.store.select(oe).subscribe(e=>{!r&&e.length===0&&(this.store.dispatch(Z()),r=!0),this.customers$=e});this.subscription.add(n)}createCustomer(){this.modalService.open(g,{functionTyeEm:"create"}),console.log("Create customer clicked")}editCustomer(r){this.modalService.open(g,{functionTyeEm:"update",customer:r}),console.log("Edit:",r)}deleteCustomer(r){this.notificationService.showConfirmationDelete("Customer",()=>{this.store.dispatch(re({id:r.id}))}),console.log("Delete:",r)}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=F({type:t,selectors:[["app-customers"]],standalone:!0,features:[S],decls:5,vars:2,consts:[[1,"px-6","h-full"],[1,"text-2xl","font-extrabold","text-gray-800","flex","items-center","gap-3"],[1,"table-books"],["type","no-view",3,"create","edit","delete","columns","data"]],template:function(n,e){n&1&&(i(0,"div",0)(1,"h1",1),s(2," Customers "),o(),i(3,"div",2)(4,"app-crud-table",3),_("create",function(){return e.createCustomer()})("edit",function(d){return e.editCustomer(d)})("delete",function(d){return e.deleteCustomer(d)}),o()()()),n&2&&(m(4),a("columns",e.columns)("data",e.customers$))},dependencies:[P]})};export{ie as CustomersComponent};
