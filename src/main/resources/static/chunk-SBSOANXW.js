import{a as te}from"./chunk-SORMBLYZ.js";import{a as X,b as Y,c as Z,d as ee}from"./chunk-WEM5JORN.js";import{a as Q}from"./chunk-46J4RIDY.js";import{a as F,b as W}from"./chunk-O22OUVCV.js";import"./chunk-YGPISVLE.js";import"./chunk-HRF36MJC.js";import{b as R,c as s,d as j,e as B,h as G,j as z,k as P,m as H,n as K,o as U,q as J}from"./chunk-OFSUVZPS.js";import{a as L}from"./chunk-S4B3EVCZ.js";import"./chunk-BJIYRU5B.js";import{f as S}from"./chunk-2T54QLAV.js";import{Ja as a,Ua as p,Xa as m,_b as D,a as I,aa as c,ab as k,ac as V,bb as O,cb as M,db as o,eb as i,ec as $,fb as x,ga as y,ib as q,jb as h,kb as f,mb as u,ob as A,pa as T,qa as w,ub as C}from"./chunk-UTOI2SA5.js";import{a as N}from"./chunk-FDERIQAA.js";function oe(t,r){t&1&&(o(0,"div"),u(1,"First name is required."),i())}function le(t,r){t&1&&(o(0,"div"),u(1,"Max 15 characters."),i())}function ae(t,r){t&1&&(o(0,"div"),u(1,"Cannot be blank or spaces only."),i())}function me(t,r){if(t&1&&(o(0,"div",20),p(1,oe,2,0,"div",21)(2,le,2,0,"div",21)(3,ae,2,0,"div",21),i()),t&2){let n,e,l,d=f();a(),m("ngIf",(n=d.authorForm.get("name"))==null||n.errors==null?null:n.errors.required),a(),m("ngIf",(e=d.authorForm.get("name"))==null||e.errors==null?null:e.errors.maxlength),a(),m("ngIf",(l=d.authorForm.get("name"))==null||l.errors==null?null:l.errors.pattern)}}function ue(t,r){t&1&&(o(0,"div"),u(1,"Last name is required."),i())}function de(t,r){t&1&&(o(0,"div"),u(1,"Max 15 characters."),i())}function se(t,r){t&1&&(o(0,"div"),u(1,"Cannot be blank or spaces only."),i())}function pe(t,r){if(t&1&&(o(0,"div",20),p(1,ue,2,0,"div",21)(2,de,2,0,"div",21)(3,se,2,0,"div",21),i()),t&2){let n,e,l,d=f();a(),m("ngIf",(n=d.authorForm.get("lastName"))==null||n.errors==null?null:n.errors.required),a(),m("ngIf",(e=d.authorForm.get("lastName"))==null||e.errors==null?null:e.errors.maxlength),a(),m("ngIf",(l=d.authorForm.get("lastName"))==null||l.errors==null?null:l.errors.pattern)}}function ce(t,r){t&1&&(o(0,"div"),u(1,"Identity number is required."),i())}function he(t,r){t&1&&(o(0,"div"),u(1,"Must be exactly 10 digits."),i())}function fe(t,r){if(t&1&&(o(0,"div",20),p(1,ce,2,0,"div",21)(2,he,2,0,"div",21),i()),t&2){let n,e,l=f();a(),m("ngIf",(n=l.authorForm.get("identityNumber"))==null||n.errors==null?null:n.errors.required),a(),m("ngIf",(e=l.authorForm.get("identityNumber"))==null||e.errors==null?null:e.errors.pattern)}}function _e(t,r){t&1&&(o(0,"div"),u(1,"Email is required."),i())}function ve(t,r){t&1&&(o(0,"div"),u(1,"Invalid email format."),i())}function ge(t,r){if(t&1&&(o(0,"div",20),p(1,_e,2,0,"div",21)(2,ve,2,0,"div",21),i()),t&2){let n,e,l=f();a(),m("ngIf",(n=l.authorForm.get("email"))==null||n.errors==null?null:n.errors.required),a(),m("ngIf",(e=l.authorForm.get("email"))==null||e.errors==null?null:e.errors.email)}}function be(t,r){if(t&1){let n=q();o(0,"div",22),h("click",function(){let l=T(n).$implicit,d=f();return w(d.selectState(l))}),u(1),i()}if(t&2){let n=r.$implicit;a(),A(" ",n," ")}}function ye(t,r){t&1&&(o(0,"div"),u(1,"State is required."),i())}function xe(t,r){t&1&&(o(0,"div"),u(1,"Invalid state selected."),i())}function Ce(t,r){if(t&1&&(o(0,"div",20),p(1,ye,2,0,"div",21)(2,xe,2,0,"div",21),i()),t&2){let n,e,l=f();a(),m("ngIf",(n=l.authorForm.get("state"))==null||n.errors==null?null:n.errors.required),a(),m("ngIf",(e=l.authorForm.get("state"))==null||e.errors==null?null:e.errors.invalidState)}}var _=class t{modalService=c(F);animationState="modal-animate-in";functionTyeEm="";author;store=c(S);_fb=c(U);toggleState=!1;stateOptions=["ACTIVE","INACTIVE"];authorForm=this._fb.group({name:["",[s.required,s.maxLength(15),s.pattern(/^(?!\s*$).+/)]],lastName:["",[s.required,s.maxLength(15),s.pattern(/^(?!\s*$).+/)]],identityNumber:["",[s.required,s.pattern(/^\d{10}$/)]],email:["",[s.required,s.email]],state:["",[s.required,r=>this.stateOptions.includes(r.value)?null:{invalidState:!0}]]});ngOnInit(){this.author&&this.authorForm.patchValue(N({},this.author))}allowOnlyNumbers(r){let n=r.charCode;(n<48||n>57)&&r.preventDefault()}selectState(r){this.authorForm.get("state")?.setValue(r),this.toggleState=!1}submit(){if(this.authorForm.valid)this.save(),this.close();else{this.authorForm.markAllAsTouched();for(let[r,n]of Object.entries(this.authorForm.controls))n.errors&&console.log(`Errores en ${r}:`,n.errors)}}save(){let r=e=>e==null||typeof e=="string"&&e.trim()===""?null:e,n={id:this.author?Number(this.author.id):0,name:r(this.authorForm.get("name")?.value),lastName:r(this.authorForm.get("lastName")?.value),identityNumber:r(this.authorForm.get("identityNumber")?.value?String(this.authorForm.get("identityNumber")?.value):null),email:r(this.authorForm.get("email")?.value),state:r(this.authorForm.get("state")?.value)};this.author?this.store.dispatch(Z({editedItem:n})):this.store.dispatch(Y({newItem:n}))}close(){this.animationState="modal-animate-out",setTimeout(()=>{this.modalService.close()},150)}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=y({type:t,selectors:[["app-form-author"]],inputs:{functionTyeEm:"functionTyeEm",author:"author"},standalone:!0,features:[C],decls:37,vars:10,consts:[[1,"fixed","inset-0","bg-black","bg-opacity-60","z-40","flex","items-center","justify-center"],[1,"w-full","max-w-md","bg-white","rounded-xl","shadow-lg","mx-4","md:mx-0",3,"ngClass"],[1,"py-8","text-center","font-bold","text-2xl","text-gray-800"],[1,"px-8","pb-8","space-y-6",3,"ngSubmit","formGroup"],["for","first_name",1,"block","mb-2","text-sm","font-medium","text-gray-900"],["type","text","id","first_name","formControlName","name","placeholder","Enter first name",1,"w-full","border","border-gray-300","rounded-lg","px-3","py-2","shadow-sm","focus:ring-blue-500","focus:border-blue-500"],["class","text-red-500 text-sm mt-1",4,"ngIf"],["for","last_name",1,"block","mb-2","text-sm","font-medium","text-gray-900"],["type","text","id","last_name","formControlName","lastName","placeholder","Enter last name",1,"w-full","border","border-gray-300","rounded-lg","px-3","py-2","shadow-sm","focus:ring-blue-500","focus:border-blue-500"],["for","identityNumber",1,"block","mb-2","text-sm","font-medium","text-gray-900"],["type","text","id","identityNumber","formControlName","identityNumber","placeholder","Enter identity number","maxlength","10","pattern","\\d*",1,"w-full","border","border-gray-300","rounded-lg","px-3","py-2","shadow-sm","focus:ring-blue-500","focus:border-blue-500","no-spinner",3,"keypress"],["for","email",1,"block","mb-2","text-sm","font-medium","text-gray-900"],["type","email","id","email","formControlName","email","placeholder","Enter email address",1,"w-full","border","border-gray-300","rounded-lg","px-3","py-2","shadow-sm","focus:ring-blue-500","focus:border-blue-500"],[1,"relative"],[1,"block","mb-2","text-sm","font-medium","text-gray-900"],["type","button",1,"w-full","border","border-gray-300","rounded","px-4","py-2","text-left","bg-white","shadow-sm","hover:bg-gray-50",3,"click"],[1,"float-right"],[1,"absolute","z-10","w-full","mt-1","bg-white","border","border-gray-300","rounded","shadow-md","max-h-60","overflow-y-auto",3,"ngClass"],[1,"px-4","py-2","hover:bg-gray-100","cursor-pointer"],[3,"closeModal","functionTyeRec"],[1,"text-red-500","text-sm","mt-1"],[4,"ngIf"],[1,"px-4","py-2","hover:bg-gray-100","cursor-pointer",3,"click"]],template:function(n,e){if(n&1&&(o(0,"div",0)(1,"div",1)(2,"h1",2),u(3,"AUTHOR FORM"),i(),o(4,"form",3),h("ngSubmit",function(){return e.submit()}),o(5,"div")(6,"label",4),u(7,"First Name"),i(),x(8,"input",5),p(9,me,4,3,"div",6),i(),o(10,"div")(11,"label",7),u(12,"Last Name"),i(),x(13,"input",8),p(14,pe,4,3,"div",6),i(),o(15,"div")(16,"label",9),u(17,"Identity Number"),i(),o(18,"input",10),h("keypress",function(d){return e.allowOnlyNumbers(d)}),i(),p(19,fe,3,2,"div",6),i(),o(20,"div")(21,"label",11),u(22,"Email"),i(),x(23,"input",12),p(24,ge,3,2,"div",6),i(),o(25,"div",13)(26,"label",14),u(27,"State"),i(),o(28,"button",15),h("click",function(){return e.toggleState=!e.toggleState}),u(29),o(30,"span",16),u(31,"\u25BC"),i()(),o(32,"div",17),O(33,be,2,1,"div",18,k),i(),p(35,Ce,3,2,"div",6),i(),o(36,"app-cancel-save-buttons",19),h("closeModal",function(){return e.close()}),i()()()()),n&2){let l,d,v,g,E,b;a(),m("ngClass",e.animationState),a(3),m("formGroup",e.authorForm),a(5),m("ngIf",((l=e.authorForm.get("name"))==null?null:l.touched)&&((l=e.authorForm.get("name"))==null?null:l.invalid)),a(5),m("ngIf",((d=e.authorForm.get("lastName"))==null?null:d.touched)&&((d=e.authorForm.get("lastName"))==null?null:d.invalid)),a(5),m("ngIf",((v=e.authorForm.get("identityNumber"))==null?null:v.touched)&&((v=e.authorForm.get("identityNumber"))==null?null:v.invalid)),a(5),m("ngIf",((g=e.authorForm.get("email"))==null?null:g.touched)&&((g=e.authorForm.get("email"))==null?null:g.invalid)),a(5),A(" ",((E=e.authorForm.get("state"))==null?null:E.value)||"Choose State"," "),a(3),m("ngClass",e.toggleState?"block":"hidden"),a(),M(e.stateOptions),a(2),m("ngIf",((b=e.authorForm.get("state"))==null?null:b.touched)&&((b=e.authorForm.get("state"))==null?null:b.invalid)),a(),m("functionTyeRec",e.functionTyeEm)}},dependencies:[$,D,V,Q,J,G,R,j,B,H,K,z,P]})};var re=class t{modalService=c(F);notificationService=c(W);store=c(S);subscription=new I;authors$=[];columns=[{field:"id",header:"Id"},{field:"name",header:"Name"},{field:"lastName",header:"Last Name"},{field:"identityNumber",header:"Identification number"},{field:"email",header:"Email"},{field:"state",header:"State"}];ngOnInit(){let r=!1,n=this.store.select(te).subscribe(e=>{!r&&e.length===0&&(this.store.dispatch(X()),r=!0),this.authors$=e});this.subscription.add(n)}createAuthor(){console.log("Create author clicked"),this.modalService.open(_,{functionTyeEm:"create"})}editAuthor(r){console.log("Edit:",r),this.modalService.open(_,{functionTyeEm:"update",author:r})}deleteAuthor(r){this.notificationService.showConfirmationDelete("Author",()=>{this.store.dispatch(ee({id:r.id}))}),console.log("Delete:",r)}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=y({type:t,selectors:[["app-authors"]],standalone:!0,features:[C],decls:5,vars:2,consts:[[1,"px-6","h-full"],[1,"text-2xl","font-extrabold","text-gray-800","flex","items-center","gap-3"],[1,"table-books"],["type","no-view",3,"create","edit","delete","columns","data"]],template:function(n,e){n&1&&(o(0,"div",0)(1,"h1",1),u(2," Authors "),i(),o(3,"div",2)(4,"app-crud-table",3),h("create",function(){return e.createAuthor()})("edit",function(d){return e.editAuthor(d)})("delete",function(d){return e.deleteAuthor(d)}),i()()()),n&2&&(a(4),m("columns",e.columns)("data",e.authors$))},dependencies:[L]})};export{re as AuthorsComponent};
