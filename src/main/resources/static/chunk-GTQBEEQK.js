import{c as y}from"./chunk-CMYGDBEU.js";import{a as I}from"./chunk-S4B3EVCZ.js";import{a as w}from"./chunk-WK7DSSTN.js";import"./chunk-BJIYRU5B.js";import{f as C,g as S,h as g}from"./chunk-2T54QLAV.js";import{Ja as u,Xa as f,a as p,aa as s,db as a,eb as c,ga as d,jb as v,mb as b,ub as h}from"./chunk-UTOI2SA5.js";import{a as m,b as l}from"./chunk-FDERIQAA.js";var O=g("invoices"),D=S(O,i=>i.invoices);var x=class i{router=s(y);store=s(C);suscription=new p;invoices$=[];columns=[{field:"numberInvoice",header:"N\xBA"},{field:"customerNames",header:"Customer"},{field:"createdAt",header:"Date Created"},{field:"state",header:"Customer State"},{field:"total",header:"Total"}];ngOnInit(){this.loadInvoices()}loadInvoices(){let t=!1,o=this.store.select(D).subscribe(r=>{!t&&r.length===0&&(this.store.dispatch(w()),t=!0),this.invoices$=r.map(e=>l(m({},e),{rawCreatedAt:e.createdAt,createdAt:e.createdAt?e.createdAt.substring(0,16).replace("T"," - "):"",customerNames:`${e.customer.name} ${e.customer.lastName}`,state:"Issued"})).sort((e,n)=>{let A=new Date(e.rawCreatedAt).getTime();return new Date(n.rawCreatedAt).getTime()-A})});this.suscription.add(o)}viewInvoice(t){this.router.navigate(["/storebooks/invoice-details"],{state:{invoice:t}})}ngOnDestroy(){this.suscription.unsubscribe()}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=d({type:i,selectors:[["app-history"]],standalone:!0,features:[h],decls:5,vars:3,consts:[[1,"px-6","h-full"],[1,"text-2xl","font-extrabold","text-gray-800","flex","items-center","gap-3"],[1,"table-books"],[3,"view","columns","data","type"]],template:function(o,r){o&1&&(a(0,"div",0)(1,"h1",1),b(2," Invoice History "),c(),a(3,"div",2)(4,"app-crud-table",3),v("view",function(n){return r.viewInvoice(n)}),c()()()),o&2&&(u(4),f("columns",r.columns)("data",r.invoices$)("type","view"))},dependencies:[I]})};export{x as HistoryComponent};
